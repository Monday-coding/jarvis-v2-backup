# ç²¾ç°¡æ¶æ§‹ç ”ç©¶ - æ€§èƒ½å„ªåŒ–

## ğŸ“Š ç•¶å‰æ¶æ§‹åˆ†æ

### ç¾æœ‰ Agent çµæ§‹

| Agent | æ¨¡å‹ | å·¥ä½œå€ | æ²™ç®± | ä¸»è¦åŠŸèƒ½ | è¤‡é›œåº¦ |
|-------|------|--------|------|----------|--------|
| **main** | zai/glm-4.7 | workspace | off | ç·¨æ’æ‰€æœ‰ agents | â­â­â­ |
| **classifier** | ollama/qwen2.5:1.5b | workspace-classifier | all | æ„åœ–åˆ†é¡ | â­ |
| **chat** | zai/glm-4.5-air | workspace-chat | all | é–’èŠå°è©± | â­â­ |
| **task** | zai/glm-4.6 | workspace-task | off | é€šç”¨ä»»å‹™ | â­â­â­ |
| **coding** | zai/glm-4.7 | workspace-coding | all | ä»£ç¢¼ç›¸é—œ | â­â­â­â­ |
| **data** | zai/glm-4.5 | workspace-data | all | æ•¸æ“šæŸ¥è©¢/è™•ç† | â­â­ |
| **qa** | zai/glm-4.7 | workspace-qa | all | è³ªé‡æª¢æŸ¥ | â­â­ |
| **system-admin** | zai/glm-4.7 | workspace-system-admin | all | ç³»çµ±ç®¡ç† | â­â­â­â­â­ |

**ç¸½è¨ˆï¼š8 å€‹ agents**

### ç•¶å‰æ€§èƒ½å•é¡Œ

1. **éå¤šçš„ agent å±¤ç´š**
   - ç°¡å–®æŸ¥è©¢ç¶“éï¼šmain â†’ classifier â†’ chatï¼ˆ3 æ¬¡èª¿ç”¨ï¼‰
   - ä»£ç¢¼ä»»å‹™ç¶“éï¼šmain â†’ classifier â†’ codingï¼ˆ3 æ¬¡èª¿ç”¨ï¼‰
   - æ¯æ¬¡èª¿ç”¨éƒ½æœ‰ç¶²çµ¡å»¶é²ï¼ˆzaiï¼‰æˆ–æ¨ç†å»¶é²ï¼ˆollamaï¼‰

2. **æ¨¡å‹é¸æ“‡ä¸å¤ æ™ºèƒ½**
   - chat agent ä½¿ç”¨ glm-4.5-airï¼ˆé›²ç«¯ï¼‰ï¼Œä½†å¾ˆå¤šç°¡å–®å°è©±å¯ä»¥ç”¨æœ¬åœ° qwen2.5:0.5b
   - classifier ä½¿ç”¨ qwen2.5:1.5bï¼Œä½†å¯ä»¥ç”¨æ›´å¿«çš„å°æ¨¡å‹
   - æ‰€æœ‰ agent éƒ½æœ‰ç¨ç«‹çš„å·¥ä½œå€ï¼Œå¢åŠ äº†ä¸Šä¸‹æ–‡å‚³éé–‹éŠ·

3. **Token æµªè²»**
   - å¤šå€‹ agent ä¹‹é–“å‚³éå®Œæ•´çš„ä¸Šä¸‹æ–‡
   - é‡è¤‡çš„ç³»çµ±æç¤º
   - æ²’æœ‰å£“ç¸®æ©Ÿåˆ¶

4. **æ²’æœ‰ç·©å­˜æ©Ÿåˆ¶**
   - å¸¸è¦‹å•é¡Œæ¯æ¬¡éƒ½é‡æ–°ç”Ÿæˆç­”æ¡ˆ
   - æ²’æœ‰ RAG ç·©å­˜

---

## ğŸ¯ ç²¾ç°¡æ¶æ§‹ç­–ç•¥

### ç­–ç•¥ 1ï¼šæ™ºèƒ½è·¯ç”± + åˆ†å±¤æ¨¡å‹ï¼ˆæ¨è–¦ â­â­â­â­â­ï¼‰

**æ ¸å¿ƒç†å¿µ**ï¼šæ ¹æ“šä»»å‹™è¤‡é›œåº¦å‹•æ…‹é¸æ“‡æ¨¡å‹å’Œ agentã€‚

#### æ¶æ§‹è¨­è¨ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    User Input                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Intelligent Router (æœ¬åœ°é¢æ¿)                    â”‚
â”‚         - é—œéµè©æª¢æ¸¬ï¼ˆé«˜å„ªå…ˆç´šï¼‰                           â”‚
â”‚         - è©±é¡Œæå–ï¼ˆä¸­å„ªå…ˆç´šï¼‰                           â”‚
â”‚         - è¤‡é›œåº¦è©•ä¼°ï¼ˆä½å„ªå…ˆç´šï¼‰                           â”‚
â”‚         - ä½¿ç”¨ qwen2.5:0.5bï¼ˆ2.3sï¼Œ397MBï¼‰               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                  â”‚                  â”‚
   ã€ç°¡å–®ä»»å‹™ã€‘        ã€ä¸­ç­‰ä»»å‹™ã€‘        ã€è¤‡é›œä»»å‹™ã€‘
   qwen2.5:0.5b        qwen2.5:3b        glm-4.7-flash
   (2.3s, æœ¬åœ°)        (7.9s, æœ¬åœ°)        (2-3s, é›²ç«¯)
        â”‚                  â”‚                  â”‚
        â†“                  â†“                  â†“
   ç›´æ¥éŸ¿æ‡‰            ç›´æ¥éŸ¿æ‡‰            ç·¨æ’ agents
   (ç„¡ subagent)      (ç„¡ subagent)      (task/coding/data)
```

#### è¤‡é›œåº¦è©•ä¼°ç®—æ³•

```python
def assess_complexity(input: str) -> str:
    """
    è©•ä¼°è¼¸å…¥è¤‡é›œåº¦
    è¿”å›: simple | medium | complex
    """

    # 1. é•·åº¦æª¢æ¸¬ï¼ˆç°¡å–®ä½†æœ‰æ•ˆï¼‰
    if len(input) < 20:
        return "simple"

    # 2. é—œéµè©æª¢æ¸¬
    simple_keywords = ["ä½ å¥½", "å—¨", "å¹«æˆ‘", "è¬è¬", "å¤©æ°£", "æ™‚é–“", "æ€éº¼"]
    if any(kw in input for kw in simple_keywords):
        return "simple"

    # 3. è¤‡é›œé—œéµè©
    complex_keywords = ["å„ªåŒ–", "æ¶æ§‹", "è¨­è¨ˆ", "èª¿è©¦", "é‡æ§‹", "éƒ¨ç½²", "é…ç½®"]
    if any(kw in input for kw in complex_keywords):
        return "complex"

    # 4. ä»£ç¢¼ç›¸é—œ
    if "ä»£ç¢¼" in input or "code" in input.lower():
        return "complex"

    # 5. é»˜èªä¸­ç­‰
    return "medium"
```

#### é…ç½®å¯¦ç¾

```json5
{
  "agents": {
    "list": [
      {
        "id": "main-smart",
        "name": "Jarvis (æ™ºèƒ½è·¯ç”±)",
        "model": "ollama/qwen2.5:0.5b",
        "subagents": {
          "allowAgents": ["chat-fast", "chat-medium", "task-complex"],
          "model": "ollama/qwen2.5:0.5b"
        }
      },
      {
        "id": "chat-fast",
        "name": "Fast Chat (å¿«é€Ÿå°è©±)",
        "model": "ollama/qwen2.5:0.5b",
        "description": "ç°¡å–®å•å€™ã€é–’èŠã€å¿«é€Ÿå›æ‡‰"
      },
      {
        "id": "chat-medium",
        "name": "Medium Chat (ä¸€èˆ¬å°è©±)",
        "model": "ollama/qwen2.5:3b",
        "description": "ä¸€èˆ¬å°è©±ã€éœ€è¦æ¨ç†çš„å•é¡Œ"
      },
      {
        "id": "task-complex",
        "name": "Complex Task (è¤‡é›œä»»å‹™)",
        "model": "zai/glm-4.7-flash",
        "description": "ä»£ç¢¼ã€ç³»çµ±æ“ä½œã€è¤‡é›œä»»å‹™"
      }
    ]
  }
}
```

#### é æœŸæ•ˆæœ

| ä»»å‹™é¡å‹ | ç•¶å‰éŸ¿æ‡‰æ™‚é–“ | å„ªåŒ–å¾Œ | æå‡å¹…åº¦ |
|----------|-------------|--------|----------|
| å•å€™ "ä½ å¥½" | ~3s (glm-4.5-air) | **2.3s** (qwen2.5:0.5b) | 23% â†‘ |
| å¤©æ°£æŸ¥è©¢ | ~5s (classifier + chat) | **2.3s** (ç›´æ¥) | 54% â†‘ |
| ä»£ç¢¼ä»»å‹™ | ~10s (main â†’ classifier â†’ coding) | **3s** (ç›´æ¥) | 70% â†‘ |
| è¤‡é›œå°è©± | ~6s (glm-4.7) | **3s** (glm-4.7-flash) | 50% â†‘ |

---

### ç­–ç•¥ 2ï¼šåˆä½µç›¸ä¼¼ Agentsï¼ˆæ¨è–¦ â­â­â­â­ï¼‰

**æ ¸å¿ƒç†å¿µ**ï¼šæ¸›å°‘ agent æ•¸é‡ï¼Œé™ä½ä¸Šä¸‹æ–‡å‚³éé–‹éŠ·ã€‚

#### åˆä½µæ–¹æ¡ˆ

| åŸå§‹ Agents | åˆä½µå¾Œ | ç†ç”± |
|-------------|--------|------|
| chat, data, qa | **assistant** | éƒ½æ˜¯ä¿¡æ¯è™•ç†é¡ï¼Œå¯ä»¥åˆä½µ |
| coding, task | **worker** | éƒ½æ˜¯åŸ·è¡Œé¡ï¼Œå¯ä»¥åˆä½µ |
| main, classifier | **orchestrator** | ç·¨æ’åŠŸèƒ½å¯ä»¥æ•´åˆ |

#### ç²¾ç°¡å¾Œæ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Orchestrator (ç·¨æ’å™¨)                      â”‚
â”‚              - ä½¿ç”¨ qwen2.5:0.5b                        â”‚
â”‚              - æ™ºèƒ½è·¯ç”±                                   â”‚
â”‚              - æ±ºç­–é‚è¼¯                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                  â”‚                  â”‚
   [ç°¡å–®]            [ä¸€èˆ¬]             [è¤‡é›œ]
   ç›´æ¥éŸ¿æ‡‰          Assistant          Worker
   (orchestrator)    (qwen2.5:3b)      (glm-4.7-flash)
                        â”‚                  â”‚
                        â”œâ”€ ä¿¡æ¯æŸ¥è©¢         â”œâ”€ ä»£ç¢¼ç·¨å¯«
                        â”œâ”€ æ•¸æ“šè™•ç†         â”œâ”€ ä»»å‹™åŸ·è¡Œ
                        â””â”€ QA æª¢æŸ¥         â””â”€ ç³»çµ±æ“ä½œ
```

#### é…ç½®å¯¦ç¾

```json5
{
  "agents": {
    "list": [
      {
        "id": "orchestrator",
        "name": "Jarvis (ç·¨æ’å™¨)",
        "model": "ollama/qwen2.5:0.5b",
        "subagents": {
          "allowAgents": ["assistant", "worker"],
          "model": "ollama/qwen2.5:0.5b"
        },
        "tools": {
          "allow": [
            "read",
            "write",
            "edit",
            "exec",
            "web_search",
            "web_fetch",
            "memory_search",
            "memory_get"
          ]
        }
      },
      {
        "id": "assistant",
        "name": "Assistant (åŠ©æ‰‹)",
        "model": "ollama/qwen2.5:3b",
        "description": "ä¿¡æ¯æŸ¥è©¢ã€æ•¸æ“šè™•ç†ã€QA",
        "tools": {
          "allow": [
            "read",
            "web_search",
            "web_fetch",
            "memory_search",
            "memory_get"
          ]
        }
      },
      {
        "id": "worker",
        "name": "Worker (å·¥ä½œå™¨)",
        "model": "zai/glm-4.7-flash",
        "description": "ä»£ç¢¼ç·¨å¯«ã€ä»»å‹™åŸ·è¡Œã€ç³»çµ±æ“ä½œ",
        "tools": {
          "allow": [
            "read",
            "write",
            "edit",
            "exec",
            "web_search",
            "web_fetch",
            "memory_search",
            "memory_get"
          ]
        }
      }
    ]
  }
}
```

#### é æœŸæ•ˆæœ

| æŒ‡æ¨™ | ç•¶å‰ | å„ªåŒ–å¾Œ | æå‡ |
|------|------|--------|------|
| Agent æ•¸é‡ | 8 | **3** | 62.5% â†“ |
| å¹³å‡èª¿ç”¨å±¤ç´š | 2.5 | **1.2** | 52% â†“ |
| ä¸Šä¸‹æ–‡å‚³éé–‹éŠ· | é«˜ | **ä½** | 60% â†“ |
| å•Ÿå‹•æ™‚é–“ | ~5s | **2s** | 60% â†“ |

---

### ç­–ç•¥ 3ï¼šæœ¬åœ°æ¨¡å‹å„ªå…ˆï¼ˆæ¨è–¦ â­â­â­â­â­ï¼‰

**æ ¸å¿ƒç†å¿µ**ï¼šå„ªå…ˆä½¿ç”¨æœ¬åœ°æ¨¡å‹ï¼Œåªåœ¨å¿…è¦æ™‚æ‰ç”¨é›²ç«¯ã€‚

#### æ¨¡å‹é¸æ“‡æ¨¹

```
User Input
    â†“
è©•ä¼°è¤‡é›œåº¦
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                               â”‚
ã€ç°¡å–®ã€‘                      ã€è¤‡é›œã€‘
qwen2.5:0.5b                  glm-4.7-flash
(2.3s, $0)                    (2-3s, ~$0.001/1K)
    â”‚                               â”‚
    â”œâ”€ å•å€™                          â”œâ”€ ä»£ç¢¼ç”Ÿæˆ
    â”œâ”€ ç°¡å–®å•é¡Œ                      â”œâ”€ è¤‡é›œæ¨ç†
    â”œâ”€ ç¢ºèª                          â”œâ”€ é•·æ–‡æœ¬è™•ç†
    â””â”€ æŒ‡ä»¤                          â””â”€ å‰µæ„ä»»å‹™
```

#### æ¨¡å‹æ€§èƒ½å°æ¯”

| æ¨¡å‹ | å¤§å° | éŸ¿æ‡‰æ™‚é–“ | æˆæœ¬ | é©ç”¨å ´æ™¯ |
|------|------|---------|------|----------|
| qwen2.5:0.5b | 397 MB | 2.3s | $0 | é–’èŠã€ç°¡å–®å•ç­” |
| qwen2.5:3b | 1.9 GB | 7.9s | $0 | ä¸€èˆ¬å°è©±ã€æ¨ç† |
| qwen2.5:1.5b | 986 MB | ~7s | $0 | åˆ†é¡ã€æª¢æ¸¬ |
| glm-4.7-flash | é›²ç«¯ | 2-3s | ~$0.001/1K | è¤‡é›œä»»å‹™ |
| glm-4.7 | é›²ç«¯ | 3-5s | ~$0.002/1K | é«˜è³ªé‡è¼¸å‡º |

#### æ™ºèƒ½é™ç´šæ©Ÿåˆ¶

```python
def select_model(input: str, complexity: str) -> str:
    """
    æ™ºèƒ½é¸æ“‡æ¨¡å‹
    æ”¯æŒé™ç´šï¼šé›²ç«¯ â†’ æœ¬åœ°
    """

    # 1. å˜—è©¦é›²ç«¯æ¨¡å‹ï¼ˆè¤‡é›œä»»å‹™ï¼‰
    if complexity == "complex":
        try:
            return call_model("zai/glm-4.7-flash", input)
        except:
            # é™ç´šåˆ°æœ¬åœ°
            print("âš ï¸  é›²ç«¯å¤±æ•—ï¼Œé™ç´šåˆ°æœ¬åœ°")
            return call_model("ollama/qwen2.5:3b", input)

    # 2. ä¸­ç­‰ä»»å‹™
    elif complexity == "medium":
        try:
            return call_model("ollama/qwen2.5:3b", input)
        except:
            # é™ç´šåˆ°å¿«é€Ÿæ¨¡å‹
            print("âš ï¸  ä¸­ç­‰æ¨¡å‹å¤±æ•—ï¼Œé™ç´šåˆ°å¿«é€Ÿæ¨¡å‹")
            return call_model("ollama/qwen2.5:0.5b", input)

    # 3. ç°¡å–®ä»»å‹™
    else:
        return call_model("ollama/qwen2.5:0.5b", input)
```

---

### ç­–ç•¥ 4ï¼šå•Ÿç”¨ Block Streamingï¼ˆæ¨è–¦ â­â­â­â­â­ï¼‰

**æ ¸å¿ƒç†å¿µ**ï¼šå³ä½¿å¯¦éš›é€Ÿåº¦ä¸è®Šï¼Œç”¨æˆ¶æ„ŸçŸ¥é€Ÿåº¦æå‡ 2-3 å€ã€‚

#### é…ç½®å¯¦ç¾

```json5
{
  "agents": {
    "defaults": {
      "blockStreamingDefault": "on",
      "blockStreamingBreak": "text_end",
      "blockStreamingChunk": {
        "minChars": 50,
        "maxChars": 300
      }
    }
  },
  "channels": {
    "telegram": {
      "streaming": "on"
    },
    "whatsapp": {
      "streaming": "on"
    }
  }
}
```

#### é æœŸæ•ˆæœ

| é…ç½® | å¯¦éš›æ™‚é–“ | æ„ŸçŸ¥æ™‚é–“ | ç”¨æˆ¶æ»¿æ„åº¦ |
|------|---------|---------|-----------|
| ç„¡ streaming | 8s | 8s | â­â­â­ |
| Block streaming | 8s | **3s** | â­â­â­â­â­ |

---

### ç­–ç•¥ 5ï¼šRAG ç·©å­˜ï¼ˆæ¨è–¦ â­â­â­â­ï¼‰

**æ ¸å¿ƒç†å¿µ**ï¼šå¸¸è¦‹å•é¡Œ < 0.1s éŸ¿æ‡‰ã€‚

#### å¯¦ç¾æ–¹æ¡ˆ

```python
class RAGCache:
    """RAG ç·©å­˜é¡"""

    def __init__(self):
        self.cache = {}
        self.kb_file = Path.home() / ".openclaw" / "workspace" / "knowledge-base.md"

    def query(self, question: str) -> Optional[str]:
        """æŸ¥è©¢ç·©å­˜"""
        if question in self.cache:
            return self.cache[question]
        return None

    def store(self, question: str, answer: str) -> None:
        """å­˜å„²åˆ°ç·©å­˜"""
        self.cache[question] = answer

    def build_from_kb(self) -> None:
        """å¾çŸ¥è­˜åº«æ§‹å»ºç·©å­˜"""
        # è§£æ knowledge-base.md
        # æå–å¸¸è¦‹å•ç­”
        # å­˜å„²åˆ°ç·©å­˜
        pass
```

#### å·¥ä½œæµç¨‹

```
User Input
    â†“
æª¢æŸ¥ RAG ç·©å­˜
    â”œâ”€ å‘½ä¸­ï¼Ÿâ†’ ç›´æ¥è¿”å›ç­”æ¡ˆï¼ˆ<0.1sï¼‰âœ…
    â””â”€ æœªå‘½ä¸­ï¼Ÿâ†’ ç¹¼çºŒ
        â†“
èª¿ç”¨ Agent
    â†“
å­˜å„²åˆ°ç·©å­˜
```

---

## ğŸš€ æ¨è–¦å¯¦æ–½æ–¹æ¡ˆ

### éšæ®µ 1ï¼šå¿«é€Ÿå„ªåŒ–ï¼ˆç«‹å³å¯¦æ–½ï¼‰

1. **å•Ÿç”¨ Block Streaming** â­â­â­â­â­
   - ç„¡éœ€ä¿®æ”¹æ¶æ§‹
   - ç«‹å³ç”Ÿæ•ˆ
   - ç”¨æˆ¶æ„ŸçŸ¥æå‡ 2-3 å€

2. **åˆ‡æ› Chat Agent åˆ°æœ¬åœ°æ¨¡å‹** â­â­â­â­â­
   - chat ä½¿ç”¨ qwen2.5:0.5b
   - ç«‹å³æå‡éŸ¿æ‡‰é€Ÿåº¦

3. **é…ç½®æ™ºèƒ½è·¯ç”±** â­â­â­â­
   - ç°¡å–®ä»»å‹™ç›´æ¥éŸ¿æ‡‰
   - è·³éä¸å¿…è¦çš„ classifier

### éšæ®µ 2ï¼šæ¶æ§‹å„ªåŒ–ï¼ˆ1-2 å¤©ï¼‰

1. **åˆä½µç›¸ä¼¼ Agents** â­â­â­â­
   - æ¸›å°‘ agent æ•¸é‡åˆ° 3 å€‹
   - é™ä½ä¸Šä¸‹æ–‡å‚³éé–‹éŠ·

2. **å¯¦ç¾ RAG ç·©å­˜** â­â­â­â­
   - å¸¸è¦‹å•é¡Œ < 0.1s éŸ¿æ‡‰
   - ç¯€çœ API èª¿ç”¨

### éšæ®µ 3ï¼šé«˜ç´šå„ªåŒ–ï¼ˆ1 å‘¨ï¼‰

1. **å¯¦ç¾æ™ºèƒ½é™ç´š** â­â­â­
   - é›²ç«¯ â†’ æœ¬åœ°é™ç´š
   - æé«˜å¯é æ€§

2. **é ç†±æ¨¡å‹** â­â­â­
   - Gateway å•Ÿå‹•æ™‚é åŠ è¼‰
   - æ¸›å°‘é¦–æ¬¡å»¶é²

---

## ğŸ“‹ å¯¦æ–½æ­¥é©Ÿ

### æ­¥é©Ÿ 1ï¼šå•Ÿç”¨ Block Streaming

```bash
# å‚™ä»½é…ç½®
cp ~/.openclaw/openclaw.json ~/.openclaw/openclaw.json.backup.streaming

# å•Ÿç”¨ streaming
jq '.agents.defaults.blockStreamingDefault = "on"' \
  ~/.openclaw/openclaw.json > /tmp/openclaw-streaming.json

jq '.channels.telegram.streaming = "on"' \
  /tmp/openclaw-streaming.json > /tmp/openclaw-streaming2.json

jq '.channels.whatsapp.streaming = "on"' \
  /tmp/openclaw-streaming2.json > ~/.openclaw/openclaw.json

# é‡å•Ÿ Gateway
openclaw gateway restart
```

### æ­¥é©Ÿ 2ï¼šåˆ‡æ› Chat Agent åˆ°æœ¬åœ°æ¨¡å‹

```bash
# åˆ‡æ› chat agent åˆ° qwen2.5:0.5b
jq '.agents.list |= map(if .id == "chat" then .model = "ollama/qwen2.5:0.5b" else . end)' \
  ~/.openclaw/openclaw.json > /tmp/openclaw-chat-local.json

cp /tmp/openclaw-chat-local.json ~/.openclaw/openclaw.json

# é‡å•Ÿ Gateway
openclaw gateway restart
```

### æ­¥é©Ÿ 3ï¼šæ¸¬è©¦æ€§èƒ½

```bash
# æ¸¬è©¦ç°¡å–®å•å€™
echo "æ¸¬è©¦éŸ¿æ‡‰æ™‚é–“..."
time (echo "ä½ å¥½" | openclaw agent call chat --stdin)

# æ¸¬è©¦è¤‡é›œä»»å‹™
time (echo "å¯«ä¸€å€‹ Python è…³æœ¬" | openclaw agent call coding --stdin)
```

---

## ğŸ“Š é æœŸæ”¶ç›Š

### æ€§èƒ½æå‡

| æŒ‡æ¨™ | ç•¶å‰ | å„ªåŒ–å¾Œ | æå‡ |
|------|------|--------|------|
| å¹³å‡éŸ¿æ‡‰æ™‚é–“ | 5-8s | **2-3s** | 60% â†‘ |
| ç°¡å–®æŸ¥è©¢æ™‚é–“ | 5s | **2.3s** | 54% â†‘ |
| ä»£ç¢¼ä»»å‹™æ™‚é–“ | 10s | **3s** | 70% â†‘ |
| Agent æ•¸é‡ | 8 | **3** | 62.5% â†“ |

### æˆæœ¬ç¯€çœ

| é …ç›® | ç•¶å‰/å¤© | å„ªåŒ–å¾Œ/å¤© | ç¯€çœ |
|------|---------|----------|------|
| é›²ç«¯ API èª¿ç”¨ | ~50 æ¬¡ | ~10 æ¬¡ | 80% â†“ |
| æ¯æ—¥æˆæœ¬ | ~$0.1 | ~$0.02 | 80% â†“ |
| æ¯æœˆæˆæœ¬ | ~$3 | ~$0.6 | 80% â†“ |

### ç”¨æˆ¶é«”é©—

| ç¶­åº¦ | ç•¶å‰ | å„ªåŒ–å¾Œ |
|------|------|--------|
| éŸ¿æ‡‰é€Ÿåº¦ | â­â­â­ | â­â­â­â­â­ |
| å¯é æ€§ | â­â­â­â­ | â­â­â­â­â­ |
| æµæš¢åº¦ | â­â­â­ | â­â­â­â­â­ |

---

## ğŸ¯ ç¸½çµ

**æ¨è–¦æ–¹æ¡ˆ**ï¼š

1. **ç«‹å³å¯¦æ–½**ï¼šå•Ÿç”¨ Block Streaming + åˆ‡æ› Chat Agent åˆ°æœ¬åœ°æ¨¡å‹
2. **çŸ­æœŸå„ªåŒ–**ï¼šåˆä½µç›¸ä¼¼ Agents + å¯¦ç¾ RAG ç·©å­˜
3. **é•·æœŸå„ªåŒ–**ï¼šæ™ºèƒ½é™ç´š + é ç†±æ¨¡å‹

**é æœŸæ•ˆæœ**ï¼š
- éŸ¿æ‡‰æ™‚é–“ï¼š5-8s â†’ **2-3s** (60% â†‘)
- Agent æ•¸é‡ï¼š8 â†’ **3** (62.5% â†“)
- æ¯æœˆæˆæœ¬ï¼š~$3 â†’ **~$0.6** (80% â†“)

---

æº–å‚™é–‹å§‹å¯¦æ–½å—ï¼Ÿæˆ‘å¯ä»¥å¹«ä½ ï¼š
1. âœ… ç«‹å³å•Ÿç”¨ Block Streaming
2. âœ… åˆ‡æ› Chat Agent åˆ°æœ¬åœ°æ¨¡å‹
3. âœ… åˆä½µç›¸ä¼¼ Agents
4. âœ… å¯¦ç¾ RAG ç·©å­˜
5. âœ… æ¸¬è©¦æ€§èƒ½æå‡

å‘Šè¨´æˆ‘ä½ æƒ³å¾å“ªä¸€æ­¥é–‹å§‹ï¼ğŸš€
