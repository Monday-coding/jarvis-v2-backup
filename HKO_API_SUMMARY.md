# HKO API 文檔快速摘要

## 📋 文檔信息

**文件名**：HKO_Open_Data_API_Documentation_tc.pdf
**大小**：84.5 KB
**頁數**：46 頁
**語言**：繁體中文

---

## 🌤 主要章節概要

### 1. 簡介
- API 提供天氣、天文等公開數據
- 支持 JSON 和 XML 格式
- 需要注冊申請 API Key（免費）

### 2. 認證方式
- **API Key 認證**（推薦）
- **IP 白名單**（可選）
- HTTPS 連接

### 3. 主要數據類型

| 類型 | 端點 | 說明 |
|------|--------|--------|
| **天氣數據** | `/weatherAPI/` | 實時天氣、預報 |
| **天文數據** | `/astroAPI/` | 日出/日落、月相、行星位置 |
| **警告資訊** | `/warning/` | 暴雨、颱風、酷熱等警告 |

---

## 🔑 認證與 API Key

### 申請 API Key

1. **訪問申請頁面**：
   - 網址：https://www.hko.gov.hk/tc/weatherAPI/doc/apply
   - 填寫申請表單

2. **所需信息**：
   - 組織名稱
   - 聯絡人電郵
   - 用途說明

3. **審核時間**：通常 1-3 個工作日

### API Key 使用方式

```bash
# HTTP Header
Authorization: apikey=YOUR_API_KEY

# 或 URL Parameter
?apikey=YOUR_API_KEY
```

---

## 🌤 天氣 API 端點

### 1. 當前天氣

```
GET /weatherAPI/opendata/hko-opendata.json
參數：
  - dataType: "HRIT" (實時數據)
  - lang: "tc" (繁體中文)
  - apikey: YOUR_API_KEY
```

**返回數據**：
- 溫度
- 濕度
- 降雨量
- 風速、風向
- 能見度
- 氣壓

### 2. 天氣預報

```
GET /weatherAPI/flw.php
參數：
  - dataType: "FLW" (預報數據)
  - lang: "tc"
  - apikey: YOUR_API_KEY
  - location: "hko" (地點)
```

**返回數據**：
- 未來 9 天天氣預報
- 每日每 3 小時預報

### 3. 警告資訊

```
GET /weatherAPI/warning.php
參數：
  - dataType: "WARN"
  - lang: "tc"
  - apikey: YOUR_API_KEY
```

**返回數據**：
- 暴雨警告
- 颱風警告
- 酷熱警告
- 山泥傾警告

---

## ⚠️ 重要限制

### 1. API 限流

- **每分鐘請求數**：限制
- **每小時請求數**：限制
- **超出限制**：返回 429 錯誤

### 2. 數據更新頻率

- **實時數據**：每 5-10 分鐘更新
- **預報數據**：每日更新數次

### 3. 緩存策略

- **建議緩存**：5-10 分鐘
- **避免頻繁請求**：減少 API 調用

---

## 🎯 實施建議

### 1. API Key 管理

- 環境變量：`HKO_API_KEY`
- 使用 `.env` 文件存儲
- 不要硬編碼在腳本中

### 2. 錯誤處理

- 捕獲 403/401 錯誤（認證失敗）
- 捕獲 429 錯誤（超出限流）
- 實現自動重試機制

### 3. 數據緩存

- 使用 Redis 或內存緩存
- �置合理的過期時間
- 實現緩存失效策略

---

## 📝 下一步

1. **申請 API Key**：
   - 網址：https://www.hko.gov.hk/tc/weatherAPI/doc/apply
   - 時間：1-3 個工作日

2. **測試 API 連接**：
   - 使用 curl 或 Postman 測試
   - 驗證端點是否可訪問

3. **實現天氣查詢功能**：
   - 獲取當前天氣
   - 獲取天氣預報
   - 檢查警告資訊

4. **集成到監控系統**：
   - 添加到 `hko_weather_monitor.py`
   - 實現頻率控制
   - 添加數據庫記錄

---

## 📊 建議的監控頻率

| 操作 | 建議頻率 | 緩存時間 |
|------|----------|----------|
| **當前天氣** | 每 10 分鐘 | 10 分鐘 |
| **天氣預報** | 每 1 小時 | 1 小時 |
| **警告資訊** | 每 5 分鐘 | 5 分鐘 |
| **颱風信息** | 每 15 分鐘 | 15 分鐘 |

---

**文檔分析完成！準備開始測試和開發。** 📚
